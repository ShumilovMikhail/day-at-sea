<div class="infrastructure">
  <h1>Инфраструктура</h1>
  <form>
    <div class="places checkboxes-block" utilsAccordion [buttonToggle]="placesChangeButton">
      <div class="checkboxes-block__header">
        <h3>Расстояние до мест</h3>
        <img src="assets/images/icons/arrow-toggle.svg" alt="" #placesChangeButton />
      </div>
      <ul class="place-list">
        @for (place of data.placesDistanceList; track $index) {
        <ng-container *ngrxLet="findCheckboxControl('placesDistance', place) as controlData">
          <li
            class="place-item"
            accountInfrastructureCheckbox
            [checkbox]="infrastructureCheckbox"
            [ngClass]="{
              active: controlData
            }"
          >
            <label class="checkbox">
              <input
                type="checkbox"
                [checked]="!!controlData"
                #infrastructureCheckbox
                (change)="onCheckboxChange(infrastructureCheckbox.checked, 'placesDistance', place, distance.value)"
              />
              <div></div>
              {{ place }}
            </label>
            <div class="distance input-container">
              <div class="input-wrapper">
                <input
                  type="text"
                  [value]="controlData ? controlData.distance : null"
                  placeholder="Расстояние"
                  (change)="onDistanceChange('placesDistance', place, distance.value)"
                  #distance
                />
              </div>
            </div>
          </li>
        </ng-container>
        }
      </ul>
    </div>
    <div class="leisures">
      <div class="leisure checkboxes-block" utilsAccordion [buttonToggle]="leisureChangeButton">
        <div class="checkboxes-block__header">
          <h3>Расстояние до мест</h3>
          <img src="assets/images/icons/arrow-toggle.svg" alt="" #leisureChangeButton />
        </div>
        <ul class="leisure-list">
          @for (leisure of data.leisureList; track $index) {
          <ng-container *ngrxLet="findCheckboxControl('leisure', leisure) as controlData">
            <li
              class="leisure-item"
              accountInfrastructureCheckbox
              [checkbox]="infrastructureCheckbox"
              [ngClass]="{
                active: controlData
              }"
            >
              <label class="checkbox">
                <input
                  type="checkbox"
                  [checked]="!!controlData"
                  #infrastructureCheckbox
                  (change)="onCheckboxChange(infrastructureCheckbox.checked, 'leisure', leisure, distance.value)"
                />
                <div></div>
                {{ leisure }}
              </label>
              <div class="distance input-container">
                <div class="input-wrapper">
                  <input
                    type="text"
                    [value]="controlData ? controlData.distance : null"
                    placeholder="Расстояние"
                    #distance
                    (change)="onDistanceChange('leisure', leisure, distance.value)"
                  />
                </div>
              </div>
            </li>
          </ng-container>
          }
        </ul>
      </div>
      <div class="leisure-water checkboxes-block" utilsAccordion [buttonToggle]="leisureWaterChangeButton">
        <div class="checkboxes-block__header">
          <h3>Отдых на воде рядом</h3>
          <img src="assets/images/icons/arrow-toggle.svg" alt="" #leisureWaterChangeButton />
        </div>
        <ul class="leisure-water-list">
          @for (leisureWater of data.leisureWaterList; track $index) {
          <ng-container *ngrxLet="findCheckboxControl('leisureWater', leisureWater) as controlData">
            <li
              class="leisure-water-item"
              accountInfrastructureCheckbox
              [checkbox]="infrastructureCheckbox"
              [ngClass]="{
                active: controlData
              }"
            >
              <label class="checkbox">
                <input
                  type="checkbox"
                  [checked]="!!controlData"
                  #infrastructureCheckbox
                  (change)="
                    onCheckboxChange(infrastructureCheckbox.checked, 'leisureWater', leisureWater, distance.value)
                  "
                />
                <div></div>
                {{ leisureWater }}
              </label>
              <div class="distance input-container">
                <div class="input-wrapper">
                  <input
                    type="text"
                    [value]="controlData ? controlData.distance : null"
                    #distance
                    placeholder="Расстояние"
                    (change)="onDistanceChange('leisureWater', leisureWater, distance.value)"
                  />
                </div>
              </div>
            </li>
          </ng-container>
          }
        </ul>
      </div>
      <div class="leisure-active checkboxes-block" utilsAccordion [buttonToggle]="leisureActiveChangeButton">
        <div class="checkboxes-block__header">
          <h3>Активный отдых рядом</h3>
          <img src="assets/images/icons/arrow-toggle.svg" alt="" #leisureActiveChangeButton />
        </div>
        <ul class="leisure-active-list">
          @for (leisureActive of data.leisureActiveList; track $index) {
          <ng-container *ngrxLet="findCheckboxControl('leisureActive', leisureActive) as controlData">
            <li
              class="leisure-active-item"
              accountInfrastructureCheckbox
              [checkbox]="infrastructureCheckbox"
              [ngClass]="{
                active: controlData
              }"
            >
              <label class="checkbox">
                <input
                  type="checkbox"
                  [checked]="!!controlData"
                  #infrastructureCheckbox
                  (change)="
                    onCheckboxChange(infrastructureCheckbox.checked, 'leisureActive', leisureActive, distance.value)
                  "
                />
                <div></div>
                {{ leisureActive }}
              </label>
              <div class="distance input-container">
                <div class="input-wrapper">
                  <input
                    type="text"
                    [value]="controlData ? controlData.distance : null"
                    #distance
                    placeholder="Расстояние"
                    (change)="onDistanceChange('leisureActive', leisureActive, distance.value)"
                  />
                </div>
              </div>
            </li>
          </ng-container>
          }
        </ul>
      </div>
    </div>
    <div class="reaches">
      <div class="reaches__block">
        <h3>Как проехать на личном транспорте?</h3>
        <textarea
          placeholder="Подробно опишите маршрут для проезда до места"
          [formControl]="form.get('reachByPrivateTransport')! | formControl"
        ></textarea>
      </div>
      <div class="reaches__block">
        <h3>Как проехать на общественном транспорте?</h3>
        <textarea
          placeholder="Подробно опишите маршрут для проезда до места"
          [formControl]="form.get('reachByPublicTransport')! | formControl"
        ></textarea>
      </div>
    </div>
    <div class="buttons-container">
      <button class="save-button" type="button">Сохранить</button>
      <button class="next-button" type="submit">Продолжить</button>
    </div>
  </form>
</div>
